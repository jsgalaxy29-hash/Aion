aion:
  name: "Aion ERP"
  version: "0.3.x"
  description: "Source de vérité modulaire : modules, menus, métabase, droits, actions, rapports, endpoints."
  regen_command: "dotnet run --project Aion.AppHost -- --regen-meta"

  conventions:
    environments: "agnostic"
    naming:
      system_tables_prefix: "S"
      reference_tables_prefix: "R"
      feature_tables_prefix: "F"
    menus:
      id_strategy: "code"          # Pas de plages numériques; l’engine génère un ID interne
      code_format: "[A-Z0-9_]+"
      route_format: "/modules/{moduleCode}"
    icons:
      library: "Lucide"            # ou Fluent, selon dispo UI
    palette:
      system:
        primary: "#0E639C"
        success: "#107C10"
        warning: "#C19C00"
        danger:  "#C50F1F"
        neutral: "#2B2B2B"
    security:
      multi_tenant:
        enabled: true
        tenant_table: "STenant"
        tenant_key_name: "TenantId"
        enforce_on:
          - scope: "all_feature_tables"
          - scope: "users"        # SUser peut porter TenantId si multi-tenant strict
      password_hashing:
        provider: "BCrypt"
        work_factor: 12
      rbac:
        merge_rule: "most_permissive_wins"
        targets:
          - target: "Menu"
            flags: ["Right1"]                    # Voir
          - target: "Module"
            flags: ["Right1","Right2","Right3","Right4","Right5"]   # Lire, Écrire, Suppr, Export, Admin
          - target: "Table"
            flags: ["Right1","Right2","Right3","Right4","Right5"]
          - target: "Action"
            flags: ["Right1"]                    # Exécuter
          - target: "Report"
            flags: ["Right1","Right2"]           # Voir, Générer
    data_policies:
      soft_delete:
        enabled: true
        fields:
          is_deleted: "IsDeleted"
          deleted_at: "DeletedAt"
          deleted_by: "DeletedBy"
      audit_trail:
        enabled: false   # journalisation avancée (S_Audit) désactivée pour 0.3.x

  system_schema:
    tables:
      - name: "SUser"
      - name: "SGroup"
      - name: "SUserGroup"
      - name: "SRightType"
      - name: "SRight"
      - name: "SMenu"
      - name: "STable"
      - name: "SField"
      - name: "SModule"
      - name: "SAction"
      - name: "STenant"     # requis par multi-tenant
    rules:
      tenant_required_on_feature_tables: true
      seed:
        right_types:
          - code: "Menu.Right1"    # Voir
          - code: "Module.Right1"  # Lire
          - code: "Module.Right2"  # Écrire
          - code: "Module.Right3"  # Supprimer
          - code: "Module.Right4"  # Exporter
          - code: "Module.Right5"  # Admin
          - code: "Table.Right1"
          - code: "Table.Right2"
          - code: "Table.Right3"
          - code: "Table.Right4"
          - code: "Table.Right5"
          - code: "Action.Right1"
          - code: "Report.Right1"
          - code: "Report.Right2"

  modules:

    - code: "SYSTEM_CATALOG"
      name: "Catalogue système"
      color: "#107C10"
      icon: "Layers"
      menus:
        - code: "SYSTEM_CATALOG_ROOT"
          label: "Catalogue système"
          route: "/modules/SYSTEM_CATALOG"
          is_leaf: true
          icon: "Layers"
      tables:
        - "SMenu"
        - "STable"
        - "SField"
        - "SModule"
        - "SAction"
      rights:
        defaults:
          group: "Administrators"
          grants:
            - target: "Module"
              flags: ["Right1","Right2","Right3","Right4","Right5"]

    - code: "SECURITY_ADMIN"
      name: "Administration sécurité"
      color: "#0E639C"
      icon: "ShieldCheck"
      menus:
        - code: "SECURITY_ADMIN_ROOT"
          label: "Sécurité"
          route: "/modules/SECURITY_ADMIN"
          is_leaf: true
          icon: "ShieldCheck"
      tables:
        - "SUser"
        - "SGroup"
        - "SUserGroup"
        - "SRightType"
        - "SRight"
        - "STenant"

    - code: "DATA_ENGINE"
      name: "Moteur de données"
      color: "#7A3E9D"
      icon: "Database"
      menus:
        - code: "DATA_ENGINE_ROOT"
          label: "Moteur de données"
          route: "/modules/DATA_ENGINE"
          is_leaf: true
          icon: "Database"
      actions:
        - code: "RegenMetadata"
          label: "Régénérer les métadonnées"
          right: { target: "Action", flag: "Right1" }
        - code: "RebuildCache"
          label: "Reconstruire le cache"
          right: { target: "Action", flag: "Right1" }

    - code: "ACTION_ENGINE"
      name: "Moteur d’actions"
      color: "#2B2B2B"
      icon: "Play"
      menus:
        - code: "ACTION_ENGINE_ROOT"
          label: "Moteur d’actions"
          route: "/modules/ACTION_ENGINE"
          is_leaf: true
          icon: "Play"

    - code: "REPORT_ENGINE"
      name: "Moteur de rapports"
      color: "#0E639C"
      icon: "BarChart"
      menus:
        - code: "REPORT_ENGINE_ROOT"
          label: "Moteur de rapports"
          route: "/modules/REPORT_ENGINE"
          is_leaf: true
          icon: "BarChart"
      reports: []   # placeholder pour 0.3.x

    - code: "CRM"
      name: "CRM"
      color: "#107C10"
      icon: "Users"
      menus:
        - code: "CRM_ROOT"
          label: "CRM"
          route: "/modules/CRM"
          is_leaf: false
          icon: "Users"
        - code: "CRM_COMPANIES"
          parent_code: "CRM_ROOT"
          label: "Entreprises"
          route: "/modules/CRM/companies"
          is_leaf: true
          icon: "Building"
        - code: "CRM_CONTACTS"
          parent_code: "CRM_ROOT"
          label: "Contacts"
          route: "/modules/CRM/contacts"
          is_leaf: true
          icon: "Contact"
      tables: []    # volontairement vide pour 0.3.x (à définir plus tard)

  endpoints: []     # section préparée mais vide (0.3.x)

  reports: []       # central registry optionnel, conservé vide pour 0.3.x
